<div class="levels-container">
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-brand">
            <a routerLink="/" class="brand-link">
                <span class="brand-icon">ğŸµ</span>
                <span class="brand-text">Adivina la CanciÃ³n</span>
            </a>
        </div>
        
        <div class="nav-actions">
            <button 
                class="nav-btn profile-btn" 
                (click)="goToProfile()"
                [disabled]="isGuest"
                [class.disabled]="isGuest"
            >
                <span class="btn-icon">ğŸ‘¤</span>
                <span class="btn-text">{{username}}</span>
            </button>
            
            <button class="nav-btn ranking-btn" (click)="goToRanking()">
                <span class="btn-icon">ğŸ†</span>
                <span class="btn-text">Ranking</span>
            </button>
            
            <button class="nav-btn logout-btn" (click)="isGuest ? goToLogin() : logout()">
                <span class="btn-icon">{{ isGuest ? 'ğŸš€' : 'ğŸšª' }}</span>
                <span class="btn-text">{{ isGuest ? 'Iniciar SesiÃ³n' : 'Cerrar SesiÃ³n' }}</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="levels-content">
        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-card">
                <h1 class="welcome-title">Â¡Hola, {{username}}!</h1>
                <p class="welcome-subtitle">Elige un nivel y comienza a jugar</p>
                <div class="user-stats">
                    <div class="stat-item">
                        <span class="stat-value">{{totalScore}}</span>
                        <span class="stat-label">Puntos Totales</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">{{levelsCompleted}}</span>
                        <span class="stat-label">Niveles Completados</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Daily Challenge Section -->
        <section class="daily-section">
            <h2 class="section-title">DesafÃ­o Diario</h2>
            <div class="daily-card" (click)="startDailyChallenge()">
                <div class="daily-header">
                    <div class="daily-icon">ğŸ“…</div>
                    <div class="daily-info">
                        <h3 class="daily-title">CanciÃ³n del DÃ­a</h3>
                        <p class="daily-description">Nueva canciÃ³n cada 24 horas</p>
                    </div>
                    <div class="daily-badge" *ngIf="!dailyCompleted">NUEVO</div>
                    <div class="daily-badge completed" *ngIf="dailyCompleted">COMPLETADO</div>
                </div>
                <div class="daily-details">
                    <div class="detail-item">
                        <span class="detail-text">Quedan {{timeRemaining.split(':')[0]}}h {{timeRemaining.split(':')[1]}}m {{timeRemaining.split(':')[2]}}s para el nuevo nivel diario</span>
                    </div>
                </div>
                <div class="daily-action">
                    <button class="play-button daily-play">
                        <span class="play-icon">ğŸ®</span>
                        <span class="play-text">Jugar Ahora</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Levels Grid -->
        <section class="levels-section">
            <h2 class="section-title">Niveles Disponibles</h2>

            <!-- Aviso de Spotify requerido -->
            <div class="spotify-warning" *ngIf="showSpotifyWarning && !isGuest">
                <div class="warning-content">
                    <h2>ğŸµ ConexiÃ³n con Spotify Requerida</h2>
                    <p><strong>Importante:</strong> Debes usar el <u>mismo email</u> que tu cuenta de Spotify</p>
                    <p>Tu email registrado: <strong>{{ userService.getCurrentUser()?.email }}</strong></p>
                    <button class="connect-spotify-btn" routerLink="/profile">
                        Conectar con Spotify
                    </button>
                </div>
            </div>

          <!-- Grid dinÃ¡mico de niveles -->
          <div class="levels-grid-modern">
            <div 
              *ngFor="let level of levels; let i = index" 
              class="level-card-modern"
              [class.completed]="level.completed"
              [class.locked]="isGuest && level.id > 10"
              [class.easter-egg]="level.id === -1"
              (click)="startLevel(level.id)"
            >
              <!-- Badge de nivel -->
              <div class="level-number" [class.easter-number]="level.id === -1">
                {{ level.id === -1 ? 'ğŸ’' : level.id }}
              </div>
              
              <!-- Estado -->
              <div class="level-status">
                <span *ngIf="level.completed" class="status-completed">âœ…</span>
                <span *ngIf="isGuest && level.id > 10" class="status-locked">ğŸ”’</span>
              </div>

              <!-- Contenido -->
              <div class="level-content">
                <h3 class="level-name">{{ level.title }}</h3>
                <p class="level-desc" *ngIf="level.description">{{ level.description }}</p>
                
                <!-- Dificultad -->
                <div class="difficulty-badge" [attr.data-difficulty]="level.difficulty.toLowerCase()">
                  {{ level.difficulty }}
                </div>

                <!-- PuntuaciÃ³n (si estÃ¡ completado) -->
                <div class="level-score-display" *ngIf="level.completed">
                  <span class="score-label">PuntuaciÃ³n:</span>
                  <span class="score-number">{{ level.score }}</span>
                </div>
              </div>

              <!-- BotÃ³n de jugar -->
              <button class="play-level-btn" *ngIf="!isGuest || level.id <= 10 || level.id === -1">
                <span class="play-icon">â–¶</span>
              </button>
            </div>
          </div>
        </section>
    </main>
</div>