<div class="game-container">
  <div class="game-header">
    <button class="back-button" (click)="goToLevels()">â† Volver</button>
    <h1>Nivel {{ levelId }}</h1>
    <div class="attempts">Intento {{ currentAttempt }}/{{ maxAttempts }}</div>
  </div>

  <div class="game-content" *ngIf="currentSong && !gameOver">
    <!-- Error de audio -->
    <div class="audio-error" *ngIf="audioError">
      âš ï¸ {{ audioError }}
      <button class="retry-btn" (click)="startAudioManually()">Reintentar</button>
    </div>

    <!-- Imagen con reveal progresivo -->
    <div class="image-container">
      <img [src]="currentSong.image_url" [class]="'reveal-' + imageQuarters" alt="Album cover">
    </div>

    <!-- Pistas textuales -->
    <div class="hints-container">
      <div class="hint" *ngIf="revealedHints.includes('year')">
        ğŸ“… AÃ±o: {{ currentSong.year }}
      </div>
      <div class="hint" *ngIf="revealedHints.includes('genre')">
        ğŸ¸ GÃ©nero: {{ currentSong.genre }}
      </div>
      <div class="hint" *ngIf="revealedHints.includes('album')">
        ğŸ’¿ Ãlbum: {{ currentSong.album }}
      </div>
      <div class="hint" *ngIf="revealedHints.includes('artists')">
        ğŸ¤ Artista: {{ currentSong.artists }}
      </div>
      <div class="hint" *ngIf="revealedHints.includes('title_hint')">
        ğŸ“ El tÃ­tulo empieza con: {{ currentSong.title_hint }}...
      </div>
    </div>
      
    <!-- BotÃ³n para iniciar audio (primera vez) -->
    <div class="audio-start" *ngIf="audioReady">
      <button class="play-audio-btn" (click)="startAudioManually()">
        â–¶ Reproducir CanciÃ³n
      </button>
    </div>

    <!-- Input respuesta -->
    <div class="answer-section">
      <input 
        type="text" 
        [(ngModel)]="userAnswer" 
        placeholder="Â¿CuÃ¡l es el tÃ­tulo de la canciÃ³n?"
        (keyup.enter)="submitAnswer()"
      >
      <button class="submit-btn" (click)="submitAnswer()">Responder</button>
      <button 
        class="hint-btn" 
        (click)="nextHint()" 
        *ngIf="currentAttempt < maxAttempts"
      >
        Siguiente Pista
      </button>
      <button 
        class="give-up-btn" 
        (click)="giveUp()" 
        *ngIf="currentAttempt === maxAttempts"
      >
        Me rindo
      </button>
    </div>

    <div class="message" *ngIf="message">{{ message }}</div>
  </div>

  <!-- Pantalla de resultado -->
  <div class="result-screen" *ngIf="gameOver">
    <div class="result-content" [class.correct]="isCorrect">
      <h2>{{ isCorrect ? 'ğŸ‰ Â¡Correcto!' : 'âŒ Game Over' }}</h2>
      <div class="song-info" *ngIf="showAnswer && currentSong">
        <p><strong>CanciÃ³n:</strong> {{ currentSong.title }}</p>
        <p><strong>Artista:</strong> {{ currentSong.artists }}</p>
        <p><strong>Ãlbum:</strong> {{ currentSong.album }}</p>
      </div>
      <p class="score" *ngIf="isCorrect">PuntuaciÃ³n: {{ score }}</p>
      <div class="result-actions">
        <button (click)="playAgain()">Jugar de nuevo</button>
        <button (click)="goToLevels()">Volver a niveles</button>
      </div>
    </div>
  </div>
</div>